✓ CUDA toolkit loaded successfully
nvcc: NVIDIA (R) Cuda compiler driver
✓ Cray MPICH loaded successfully
Environment setup complete!
=========================================
Starting NON-DETERMINISTIC NO-HDD FULL execution (build + merge in memory)
Starting execution at: Wed Jan 28 09:32:10 PM UTC 2026
=========================================
SHARDS SET TO 6.
N SET TO 10000000.
MODE SET TO full.
Setting up db_size = 10000000
GPU 0: db_size = 10000000
GPU 1: db_size = 10000000
GPU 2: db_size = 10000000
Loading data from: ../data/vectors.fvecs
Loading all vector data into memory (parallel mode)...
Loading shard 0: position=0, count=1666666
Loading shard 1: position=1666666, count=1666666
Loading shard 2: position=3333332, count=1666666
Loading shard 3: position=4999998, count=1666666
Loading shard 4: position=6666664, count=1666666
Loading shard 5: position=8333330, count=1666670
Successfully loaded shard 1
Successfully loaded shard 5
Successfully loaded shard 3
Successfully loaded shard 4
Successfully loaded shard 0
Successfully loaded shard 2
All vector data loaded successfully (parallel)
Successfully loaded 10000000 vectors of dimension 12 into 6 shards
Data path: ../data/vectors
Total vecs num: 10000000
Shards num: 6
Max vecs num. per shard: 10000000
Vecs num. per shard: 1666666
Vecs num. of last shard: 1666670
Vector data loaded for 6 shards
Local KNN graphs stored for 0 shards
Global KNN graphs stored for 0 shards
-> 10000000
Iniciou?GPU 0 is activated
GPU 1 is activated
GPU 2 is activated
Building No. 1
Building No. 2
Building No. 0
End building No.1 in 1.29411 seconds
End building No.0 in 1.32764 seconds
End building No.2 in 1.33595 seconds
Stored local KNN graph for shard 1
Stored global KNN graph for shard 1
Stored local KNN graph for shard 0
Stored global KNN graph for shard 0
Stored local KNN graph for shard 2
Stored global KNN graph for shard 2
GPU 0 is activated
GPU 1 is activated
GPU 2 is activated
Building No. 3
Building No. 5
Building No. 4
End building No.3 in 1.27419 seconds
End building No.5 in 1.28437 seconds
End building No.4 in 1.28311 seconds
Stored local KNN graph for shard 3
Stored global KNN graph for shard 3
Stored local KNN graph for shard 5
Stored global KNN graph for shard 5
Stored local KNN graph for shard 4
Stored global KNN graph for shard 4

Iniciando o merge
Shard 0 foi ativado e ira comecar
END para 0 -> 22678389741536 

Shard 0 foi read e ira comecar
Merge costs: J = 1 I = 0 6.29562
Merge costs: J = 2 I = 0 6.91378
Merge costs: J = 3 I = 0 6.26841
Shard 1 foi ativado e ira comecar
END para 1 -> 22678391842784 

Shard 1 foi read e ira comecar
Merge costs: J = 4 I = 0 6.22328
Merge costs: J = 2 I = 1 6.68214
Merge costs: J = 5 I = 0 6.40432
Merge costs: J = 3 I = 1 6.20589
Merge costs: J = 4 I = 1 6.03394
Shard 2 foi ativado e ira comecar
END para 2 -> 22678393944032 

Shard 2 foi read e ira comecar
Merge costs: J = 5 I = 1 6.26764
Merge costs: J = 3 I = 2 6.65093
Merge costs: J = 4 I = 2 6.57122
Merge costs: J = 5 I = 2 6.75494
Shard 3 foi ativado e ira comecar
END para 3 -> 22678393944032 

Shard 3 foi read e ira comecar
Merge costs: J = 4 I = 3 6.04496
Merge costs: J = 5 I = 3 6.2384
Iniciando o último merge
Shard 4 foi ativado e ira comecar
END para 4 -> 140727745750272 

Shard 4 foi read e ira comecar
Merge costs: J = 5 I = 4 6.11124
Writing final merged KNN graphs to disk...
Writing all global KNN graphs to file: ../results/NNDescent-KNNG.kgraph
Na hora de criar o grafo: NUM: 10000000 e DIM = 32
SIZET = 2640000000
Writing shard 0 to position 0 with 1666666 vectors
Writing shard 1 to position 1666666 with 1666666 vectors
Writing shard 2 to position 3333332 with 1666666 vectors
Writing shard 3 to position 4999998 with 1666666 vectors
Writing shard 4 to position 6666664 with 1666666 vectors
Writing shard 5 to position 8333330 with 1666670 vectors
Successfully wrote all global KNN graphs to file
Final merged graphs written to: ../results/NNDescent-KNNG.kgraph
Time cost = 92.722282 
=========================================
Execution finished at: Wed Jan 28 09:34:31 PM UTC 2026
Total time elapsed: 2 minutes 21 seconds
=========================================
